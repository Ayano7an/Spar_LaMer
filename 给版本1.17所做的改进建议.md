##

## 最新的 LaMer 1.30 版 ，即 LaMer130 已经实现了大部分功能。
修改建议会在实践中产生，一个启示是：Claude更倾向于逐个实现功能，但巫獭认为，在设计软件时，依旧需要统筹考虑。

## 对于第一版
v.1.0 

需要提出一系列修改建议，采用模块化层层递进的方法让Claude补充功能。
Python方案比React方案好读，更适合我。

### 数据输出改用pandas+csv 和 json混合的模式
对于商品的全局属性，使用json存储。
其他的记录，例如出库的三种模式，使用csv文档记录。

最终还要一个商品历史记录，也用csv存户。

### 汇率方面 v17 没有提供更新的接口
给商品新增唯一属性
计算四种货币之间的汇率变化
欧元 人民币 日元 美元 

汇率计算的部分目前而言，只有2个地方，一个是可能的在货物检视页面能根据实际的金额排序，而非100rmb>99欧元，为此需要使用一个当月汇率快照来计算历史汇率，然后所有商品根据历史汇率计算得到的本币货币值排序。
实现方面，就在最后货物检视新增一列用于存储这个数据。

汇率快照可以找一个csv文件单独存储和读取，为便于计算，基准币种在LaMer中被锁定为EUR，即所有开支换算为EUR后排序。

第二个地方是本周/上周 和 本月/上月 开销对比图方面，
这里直接取用经过上一步基准处理过后的欧元计算，避免因为跨月份导致的汇率数据不一致问题。
基于欧元汇率计算得到的这个数目可以根据对应月份的总额。


### 快速输入 v17 有了
？模式 #模式 和 $模式 都没有

这个模式的意思是：
?模式和#模式都是匹配已经存入数据库的字符串的自动补全功能。#模式对应一个类型数据库，数据来源是 ## 之后的字符，这个字符和物品信息总的「商品类型」一致，但是从商品类型中。

其中
G&G Apfel 1kg >> 2.99 
`>>` 左侧的代表物品的商品名，右侧是价格，如果没有备注则默认为原价。这行就代表 G&G Apfel 1kg 的价格是2.99欧，结合元数据，可知该商品在EDEKA购买，日期也可知。

GOETH MUES :: Goethe Müsli 600g >>  5.99 :: 4.99
中 >> 左侧的 GOETH MUES :: Goethe Musli 600g 意味着 商品名为 Goethe Musli 600g的物品在EDEKA（即入金账户方）的发票名是 GOETH MUES。在录入物品信息时，将发票名信息录入对应属性内。
而 >> 右侧的价格信息 5.99 :: 4.99 表示这个 4.99是优惠后的价格，原价为 5.99 ，录入商品信息时，将折扣后价格录入购买价格属性中，原价录入标准价格中。 
但是有折扣价格的这个条目的优惠价格不会被计入?模式的自动补全字典中，即
这次录入账单后，将
GOETH MUES :: Goethe Müsli 600g >>  5.99 
录入字典，如果字典中已有这条就跳过。
下次以?模式输入时，提示的自动补全中不含优惠价格字符。
优惠价格需要手动根据购物发票调整。


### 本周上周消费对比 v17 有了
上周或上个月的数据没有显色
累计支出不知道为什么单位变成了k 一周花10000欧还是太有实力了

### 批量出库 --> 订阅模式 v17有了
和出库相关功能的页面直接删除。
订阅模式输入的信息和一般购物类似，区别在于
在检视页面，会显示为 
Crunchyroll (M250902) 字样，M表示商品按月付费，后面的数字表示该商品的续费日期，但是这一功能只是显式意义上的，而非底层数据层面，底层数据仍然照常将不同月份的Crunchyroll 订阅视为同一个商品被购买多次。

当日期到达次月同日，即20251002时，自动入库一个新的Crunchyroll 商品，将原先的Crunchyroll商品以默认模式出库（默认模式利用率为100%）

按年付费的标记为Y 

为了区分不同区分不同类型的商品，在商品全局属性数据库中增加一个商品的全局属性——「买断状况」
买断状况：
- True 适用大部分商品，默认为真
- False 通过订阅模式输入的商品拥有这个属性，

买断属性为假的货物，自动适用订阅模式。



### 押金处理的优化部分  v20+ Claude自己创立了非常复杂的模式，致使代码输出不完整。
需要补充在出库功能方面。
进一步抽象并简化逻辑，
设置三个出库模式：
1. 通常出库（输入利用率） 映射真实世界的赠送、丢弃或使用完毕等行为。
2. 遗失出库（什么都不补充，直接转入对应的库）
3. 出售出库（选择入账账户，日期，并补充金额）

### 多币种统计部分
统计的是库存的余额，
其实这部分甚至不需要显示，只需要在折线图中提供一个币种转换选项就行，汇率选择该周或者月的汇率计算即可。对于特定固定月份，月初存一个汇率快照，然后该月就采用固定的汇率计算。

### 货物的数量类型统计
可以直接删除

### 开发禁区
- 不用条码扫描功能，使用起来并不如预期方便，很多数据都要手动填写。
